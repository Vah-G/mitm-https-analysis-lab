# MITM HTTPS Analysis Lab

This project demonstrates a practical Man-In-The-Middle (MITM) scenario
where HTTPS traffic from a Windows machine is intercepted using a Kali Linux system
in a controlled lab environment.

The goal of the project is to understand how MITM attacks affect TLS/HTTPS connections
and how such activity can be identified through certificate and traffic analysis.

---

## Project Goal

- Simulate a MITM scenario in a lab environment
- Intercept and observe HTTPS traffic
- Analyze X.509 certificates and trust chains
- Identify changes caused by interception

---

## Environment

- Interceptor: Kali Linux
- Client: Windows PC
- Network: Local lab network
- Traffic: HTTPS connections to public websites
- Scope: Controlled, educational environment

---

## Tools Used

- Kali Linux
- mitmproxy
- Wireshark
- Web browser (Chrome / Firefox)

---

## Experiment Overview

### 1. Baseline HTTPS Connection
- Direct HTTPS connection from Windows to a website
- Inspection of:
  - Certificate issuer
  - Validity period
  - Certificate chain
  - Certificate fingerprint

### 2. MITM Setup
- Kali Linux configured as an HTTPS proxy
- Windows traffic routed through the proxy
- Substitute certificates generated by mitmproxy

### 3. Certificate Analysis
- Comparison of certificates before and during interception
- Identification of:
  - Issuer changes
  - Trust chain modification
  - Browser trust behavior

---

## mitmproxy Traffic Interception

mitmproxy was used to observe application-layer HTTPS traffic.
A sample HTTPS flow was captured and inspected, showing request and response metadata.

This demonstrates visibility into HTTPS communication once a malicious
certificate authority is trusted by the client system.

---

## Wireshark TLS Traffic

Two key observations were captured in Wireshark:

1. **Client Hello**  
   The initial handshake from the Windows client to the server is visible,
   confirming the establishment of an encrypted TLS session.

2. **Encrypted Application Data**  
   Application Data packets demonstrate that after the handshake,
   payload contents remain encrypted and cannot be read at the packet level.
   Only metadata such as IP addresses, ports, and packet sizes is visible.

These screenshots illustrate the difference between network-level capture
(Wireshark) and application-layer interception (mitmproxy).

---

## Key Observations

- HTTPS traffic remains encrypted, but trust can be manipulated
- Certificate issuer and trust chain change during MITM interception
- Browser security relies on trusted Certificate Authorities

---

## Possible Extensions

- Deeper packet analysis using PCAP files
- Comparison with non-proxied traffic captures
- Detection techniques from a defensive perspective

---

## Final Cleanup

After completing the lab, all MITM-related configurations were reverted:

- Proxy settings were disabled on the Windows client
- The mitmproxy root CA certificate was removed from the trusted certificate store
- mitmproxy was stopped on the Kali system
- No persistent MITM configuration remained active

This ensures that the lab environment was returned to a secure default state.


